<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/gemini-styles.css">
    <title>Wukong AI Image Generator</title>
</head>
<body>
    <div class="app-container">
        <!-- Modern Header Section -->
        <div class="header">
            <div class="header-content">
                <div class="header-icon">üêí</div>
                <div class="header-text">
                    <h1 data-i18n="app.title">Wukong AI Image Generator</h1>
                    <p data-i18n="app.subtitle">Intelligent Image Generation Tool Based on Google Gemini API</p>
                </div>
                <button id="langSwitcher" class="lang-switcher" title="Switch Language" aria-label="Switch Language">üåê</button>
            </div>
        </div>

        <div class="main-content">
            <!-- API Configuration Section (Title Hidden) -->
            <div class="config-section" id="configSection">
                <div class="form-group">
                    <div class="api-input-group">
                        <input type="password" id="apiKey" name="apiKey" placeholder="API Key *" required>
                        <button type="button" id="toggleApiKey" class="toggle-btn" data-i18n="btn.show">Show</button>
                        <button type="button" id="saveConfig" class="save-btn" data-i18n="btn.save">Save</button>
                    </div>
                    <div id="configStatus" class="config-status"></div>
                </div>
            </div>

            <!-- Image Upload Section -->
            <div class="upload-section">
                <!-- Generate Button and Usage Check Button - One Line -->
                <div class="generate-button-container">
                    <button id="generateBtn" class="generate-button fit-text" data-i18n="btn.generate">Generate</button>
                    <button id="queryUsageBtn" class="usage-button fit-text" data-i18n="btn.usage">Check Usage</button>
                </div>
                <!-- Action Buttons - Three Buttons per Line -->
                <div class="upload-buttons-container">
                    <button id="uploadFullCanvas" class="upload-button fit-text" data-i18n="btn.fullCanvas">Full Canvas</button>
                    <button id="uploadLayerCanvas" class="upload-button fit-text" data-i18n="btn.layerCanvas">Layer Canvas</button>
                    <button id="uploadQuickLayer" class="upload-button fit-text" data-i18n="btn.quickLayer">Quick Layer</button>
                </div>
                <div class="multi-preview-container">
                    <!-- Preview Box 1 -->
                    <div class="preview-slot" data-slot="0">
                        <div class="preview-container">
                            <div class="image-drop-zone clickable-drop-zone" id="imageDropZone0">
                                <div class="upload-status"></div>
                                <div class="drop-text" data-i18n="hint.drop">Click button to get image</div>
                                <img id="imagePreview0" class="image-preview" alt="Preview Image">
                                <div class="loading-indicator" style="display: none;">
                                    <div class="spinner"></div>
                                    <div data-i18n="hint.uploading">Uploading...</div>
                                </div>
                                <button class="remove-image-btn" onclick="window.imageHandler.removeImage(0)">√ó</button>
                            </div>
                        </div>
                        <div class="slot-label" data-i18n="slot.1">Image 1</div>
                    </div>
                    
                    <!-- Preview Box 2 -->
                    <div class="preview-slot" data-slot="1">
                        <div class="preview-container">
                            <div class="image-drop-zone clickable-drop-zone" id="imageDropZone1">
                                <div class="upload-status"></div>
                                <div class="drop-text" data-i18n="hint.drop">Click button to get image</div>
                                <img id="imagePreview1" class="image-preview" alt="Preview Image">
                                <div class="loading-indicator" style="display: none;">
                                    <div class="spinner"></div>
                                    <div data-i18n="hint.uploading">Uploading...</div>
                                </div>
                                <button class="remove-image-btn" onclick="window.imageHandler.removeImage(1)">√ó</button>
                            </div>
                        </div>
                        <div class="slot-label" data-i18n="slot.2">Image 2</div>
                    </div>
                    
                    <!-- Preview Box 3 -->
                    <div class="preview-slot" data-slot="2">
                        <div class="preview-container">
                            <div class="image-drop-zone clickable-drop-zone" id="imageDropZone2">
                                <div class="upload-status"></div>
                                <div class="drop-text" data-i18n="hint.drop">Click button to get image</div>
                                <img id="imagePreview2" class="image-preview" alt="Preview Image">
                                <div class="loading-indicator" style="display: none;">
                                    <div class="spinner"></div>
                                    <div data-i18n="hint.uploading">Uploading...</div>
                                </div>
                                <button class="remove-image-btn" onclick="window.imageHandler.removeImage(2)">√ó</button>
                            </div>
                        </div>
                        <div class="slot-label" data-i18n="slot.3">Image 3</div>
                    </div>
                </div>
            </div>

            <!-- Aspect Ratio (Whole control hidden, code retained) -->
            <div class="form-group" style="display: none;">
                <select id="aspectRatio" name="aspectRatio">
                    <option value="">Original Aspect Ratio</option>
                    <option value="1:1">1:1 Square (512x512)</option>
                    <option value="3:4">3:4 Portrait (512x683)</option>
                    <option value="4:3">4:3 Landscape (683x512)</option>
                    <option value="9:16">9:16 Phone Portrait (512x910)</option>
                    <option value="16:9">16:9 Widescreen (910x512)</option>
                    <option value="2:3">2:3 Poster Portrait (512x768)</option>
                    <option value="3:2">3:2 Poster Landscape (768x512)</option>
                </select>
            </div>

            <!-- Preset Prompt Selection (Custom dropdown, title hidden) -->
            <div class="form-group">
                <div id="presetDropdown" class="preset-dropdown">
                    <div id="presetTrigger" class="preset-trigger" tabindex="0" data-i18n="preset.placeholder">Select a preset template...</div>
                    <div id="presetMenu" class="preset-menu" style="display:none;"></div>
                </div>
            </div>

            <!-- Prompt Input (Title hidden) -->
            <div class="form-group">
                <textarea id="prompt" name="prompt" placeholder="ÊèèËø∞ÊèêÁ§∫ËØç *" data-i18n-attr="placeholder" data-i18n="prompt.placeholder" required></textarea>
            </div>

            <!-- Generation Count Selection (Title hidden) -->
            <div class="form-group">
                <select id="batchSize" name="batchSize">
                    <option value="1" data-i18n="batch.1">1 Image</option>
                    <option value="2" data-i18n="batch.2">2 Images</option>
                    <option value="3" data-i18n="batch.3">3 Images</option>
                    <option value="4" data-i18n="batch.4">4 Images</option>
                </select>
            </div>

            <!-- Model Type - Hidden -->
            <div class="form-group" style="display: none;">
                <label for="modelType">Model Type</label>
                <select id="modelType" name="modelType">
                    <option value="gemini-2.5-flash-image-preview" selected>Gemini 2.5 Flash (Image Preview)</option>
                    <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (Experimental)</option>
                </select>
            </div>

            <!-- Quick Actions Switch -->
            <div class="quick-actions">
                <div class="switch-container">
                    <label class="switch">
                        <input type="checkbox" id="stretchToCanvasSwitch">
                        <span class="slider"></span>
                    </label>
                    <span class="switch-label" data-i18n="switch.stretch">Auto-scale to canvas</span>
                </div>
            </div>

            <!-- Generate button moved up to the upload section -->

            <!-- Loading State -->
            <div class="loading" id="loading" style="display: none;">
                <div class="spinner"></div>
                <p data-i18n="loading.generating">Generating images, please wait...</p>
            </div>

            <!-- Results Section -->
            <div class="results compact" id="results" style="display: none;">
                <div class="results-header">
                    <h3 data-i18n="results.title">Query Results</h3>
                    <button class="close-results-btn" id="closeResultsBtn" title="Close" data-i18n-attr="title" data-i18n="results.closeTitle">√ó</button>
                </div>
                <div class="text-output" id="textOutput"></div>
            </div>

        </div>
    </div>

    <script src="js/WKPSCOMFYUI.js"></script>

</body>
</html>
